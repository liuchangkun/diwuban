______________________________________________________________________

## description: 可观测性指标（指标字典、命名、导出与采样）

# 可观测性指标

> 与 [10-logging-spec.mdc](mdc:.cursor/rules/10-logging-spec.mdc) 协同使用。

## 指标字典

- 计数：`rows_loaded`、`rows_deduped`、`rows_merged`、`rows_failed`。
- 时延：`load_cost_ms`、`merge_cost_ms`、`batch_cost_ms`。
- 状态：`concurrency_level`、`retry_attempts`、`backpressure_active`。

## 命名规范

- `app.<module>.<event>.<metric>`，单位清晰（ms/rows/ratio）。

## 采样策略

- 大量样本仅保留 P50/P90/P95/P99；
- 关键事件完整记录；
- 采样率可配置（见 logging.yaml）。

## 导出示例（日志落盘）

```json
{"event":"metrics.batch","rows_loaded":50000,"batch_cost_ms":1800,"p95_ms":1900,"backpressure_active":false}
```
