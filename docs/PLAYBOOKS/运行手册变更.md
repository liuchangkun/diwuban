## 2025-08-19 新增 VSCode 启动包装脚本（dev_suite_server.cmd）
- 背景：VSCode Augment 插件 UI 仅有 Command 文本框，无法传递 args，导致 MCP 进程启动时脚本路径未作为参数传入，引发超时（-32001）。
- 变更：新增 scripts/mcp/dev_suite_server.cmd，设置 REPO_ROOT、PYTHONUTF8，并调用 .venv Python 执行 dev_suite_server.py。
- 使用：
  - VSCode Augment → MCP Servers → dev-suite → Command 指向绝对路径：D:\Augment\diwuban\scripts\mcp\dev_suite_server.cmd
  - 可不再在 UI 中设置 Environment Variables（脚本已设置）。
- 影响：
  - 解决 UI 无 args 导致的启动失败；不改变 MCP 行为逻辑。
- 验证：
  - 本地通过 .cmd 启动，initialize 返回 serverInfo（dev-suite 0.1.0, protocol 2024-11-05）。
- 2025-08-19：在 .vscode/settings.json 新增 augment.mcpServers（使用 .venv Python + args 脚本路径），用于 VSCode Augment 插件稳定连接 MCP；如 UI 存在同名项会覆盖，需删除 UI 项并 Reload Window。

- 2025-08-19：新增 Docker 方案A（docker/dev-suite.Dockerfile、scripts/docker/build_dev_suite.ps1、run_dev_suite.ps1、VSCode 配置片段），用于一键运行 MCP，避免 VSCode UI 无 args 与本机依赖冲突。


## 2025-08-20 默认工具启用说明（Context 7 + Sequential thinking）
- 概要：在 VSCode Augment + dev-suite MCP 的使用场景中，默认启用 Context 7（文档检索）与 Sequential thinking（任务分解与反思）。
- 操作要点：
  - PR 前请勾选严格模式清单中的“MCP 默认工具确认”。
  - 如工具不可用，请在 PR 的“异常与豁免”说明原因与替代验证证据。
- 关联文档：
  - docs/智能助手行为控制.md（默认工具条款）
  - docs/开发环境-DevSuiteMCP-接入指南.md（默认工具章节）
  - docs/VSCode-Augment-MCP-Docker-使用指南.md（默认工具章节）


## 2025-08-20 流程与模板同步（MCP 豁免说明）
- 概要：细化 PR 模板与严格模式核对清单，要求“若 MCP 豁免，需提供替代验证证据与风险评估”。
- 变更内容：
  - .github/PULL_REQUEST_TEMPLATE.md：在“【必选】MCP 默认工具确认”区块，补充豁免说明文案（需替代验证与风险评估）。
  - docs/严格模式-核对清单.md：在“六、MCP 默认工具确认”新增核对项，要求豁免时附上替代验证证据与风险评估，并在 PR 中记录。
- 验证与演练：
  - 新建 PR 草稿，检查模板出现新增说明；勾选与填写是否符合新要求。
  - 使用本次里程碑2埋点的变更作为示例，演练填写流程。
- 回滚/恢复：
  - git revert 对应提交，恢复模板与清单旧文案。
- 参考链接：
  - docs/PLAYBOOKS/配置变更记录.md（CONF-20250820-005）
  - .github/PULL_REQUEST_TEMPLATE.md
  - docs/严格模式-核对清单.md


# 运行手册变更（Runbook Changes）

用途
- 记录运维流程/值班手册的更新与验证，保证操作一致性

记录模板（复制使用）
---
id: RUNBOOK-YYYYMMDD-XXX
date: YYYY-MM-DD
scope: <范围>
summary: <一句话摘要>
---
- 变更内容：
- 受影响操作/角色：
- 验证与演练：
- 回滚/恢复：
- 参考链接：



## 2025-08-20 数据质量报表链路（S1 Quick Wins）与验证
- 背景：完善 reporting/data_quality.py 的健壮性与可观测性，降低内存峰值与提高可追溯性。
- 变更：
  - perf.ndjson 改为逐行流式解析，新增 parse_errors 统计；缺失 perf 文件时输出默认结构并记录 data_report.perf.missing
  - 报告文件命名携带 run_id（data_quality_report.<run_id>.json）；生成成功时记录 data_report.generated（含 run_id/window/report_path/groups_count）
- 验证：
  - 运行 scripts/dev/run_data_report.py（窗口 2025-08-11~2025-08-18，run_dir=logs/runs/mcp_quickwin）
  - 生成 reports/data_quality_report.MCP_QUICKWIN_TEST.json；app.ndjson 含 data_report.generated
- 风险与回滚：
  - 风险低；如出现性能退化，回退至按文件读入的实现版本；事件保留
- 参考：app/services/reporting/data_quality.py；scripts/dev/run_data_report.py
