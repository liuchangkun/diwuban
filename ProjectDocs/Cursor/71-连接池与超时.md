---
description: 连接池与超时（池大小、借还超时、空闲回收、net_read/write_timeout、保活）
---
# 连接池与超时

## 池大小
- min_size/max_size 按 CPU/任务并发与 DB 许可设置（默认 1/10）；
- 监控池耗尽、借还超时与排队时间；达到阈值需扩容或降并发。

## 借还与空闲
- 借出超时 2-5s；空闲回收小于 `wait_timeout/interactive_timeout`（通常 8-15 分钟）。

## 网络超时组合
- `connect_timeout` 3-5s；`read_timeout/write_timeout` 30-60s；
- 大事务/批写入优先分批提交，避免写超时连续触发重试。

## 保活与重连
- 周期性 `SELECT 1` 或驱动 keepalive；断线自动重连（限制频率与次数），保留原 `trace_id`。

## 诊断
- 记录连接创建/释放、借出等待、断线次数；生成健康检查报表。