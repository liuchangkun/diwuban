---
description: 索引与执行计划（命名/顺序、覆盖索引、EXPLAIN/ANALYZE、慢查询整改）
---
# 索引与执行计划

## 命名与顺序
- 命名：`idx_<table>_<col1>_<col2>`；复合索引列顺序按“等值→范围→排序/分组”。
- 示例：`idx_station_time (station_id, standard_time)`、`uk_device_time (device_id, standard_time)`。

## 覆盖优先
- 使用覆盖索引减少回表；只保留必要索引，避免写放大。

## EXPLAIN/ANALYZE 要点
- 关注 `type`（ALL/INDEX/RANGE/REF）、`rows`、`filtered`、`extra`（Using index/where/filesort）；
- `ANALYZE` 提供实际耗时；RANGE/REF 优于 ALL。

## 慢查询整改步骤
1) 加时间窗与等值谓词，命中 `(device_id, standard_time)` 或 `(station_id, standard_time)`；
2) 移除 JSON 过滤或后移至子查询；
3) 必要时临时物化中间结果；
4) 验证 EXPLAIN/ANALYZE 收敛。

## 关系
- 遵循 `aligned_data`